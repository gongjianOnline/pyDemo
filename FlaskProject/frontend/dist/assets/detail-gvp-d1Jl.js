import{d as se,o as oe,r as d,X as ne,c as h,e as t,f as l,w as a,g as n,k as r,h as b,m as de,t as u,H as ie,F as R,n as S,p as Y,a2 as ue,x as q,M as G,O as m,P as re}from"./index-iZTeaJac.js";import{f as pe,e as me,g as ce}from"./index-BSUptXTg.js";const _e={class:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-4"},fe={class:"max-w-7xl mx-auto"},ve={class:"flex items-center justify-between mb-4"},xe={class:"text-base font-semibold text-blue-600 flex items-center"},be={class:"grid grid-cols-2 md:grid-cols-5 gap-x-8 gap-y-3"},ge={class:"flex items-center space-x-2"},ye={class:"font-medium text-gray-800"},we={class:"flex items-center space-x-2"},he={class:"font-medium text-gray-800"},Ve={class:"flex items-center space-x-2"},Ce={class:"font-medium text-gray-800"},ke={class:"flex items-center space-x-2"},Ue={class:"font-medium text-gray-800"},De={class:"flex items-center space-x-2"},Fe={class:"font-medium text-gray-800"},Ie={class:"flex flex-col lg:flex-row lg:items-center justify-between mb-4 space-y-2 lg:space-y-0"},Ye={class:"text-base font-semibold text-blue-600 flex items-center"},Me={class:"flex items-center space-x-4"},Pe={class:"flex flex-col lg:flex-row lg:items-center justify-between mb-6 space-y-2 lg:space-y-0 bg-blue-50/60 p-4 rounded-xl border border-blue-100"},Ee={class:"flex-1 lg:max-w-xs"},je={class:"flex-shrink-0"},Ne={class:"mt-4"},ze={class:"text-sm font-medium text-gray-700 mb-3 pb-2 border-b border-blue-100"},Ae={key:0,class:"text-center py-12 text-gray-500"},Te={class:"flex items-center justify-between mb-2"},Be={class:"flex items-center space-x-2"},Re={class:"text-xs text-gray-500"},Se={class:"space-y-2 text-sm"},qe={class:"bg-blue-50/80 p-3 rounded-lg"},Ge={class:"text-blue-700 leading-relaxed"},He={class:"bg-green-50/80 p-3 rounded-lg"},Le={class:"text-green-700 leading-relaxed"},Oe={class:"flex justify-end space-x-2"},Xe=se({__name:"detail",setup($e){const H=ne();oe(()=>{V()});const c=d("0"),_=d([]),V=async()=>{const s=await pe({patient_id:H.query.patient_id});C.value=s.data.patient_info.patient_id,M.value=s.data.patient_info.name,P.value=s.data.patient_info.age,E.value=s.data.patient_info.gender===0?"男":"女",j.value=s.data.patient_info.main_diagnosis,N.value=s.data.patient_info.doctor_name,_.value=s.data.templates,U.value=s.data.templates.map(e=>({label:e.template_name,value:e.template_id})),p.value=U.value[0].value,k.value=(s.data.templates[0].visit_ids[0]||"").toString(),g.value=s.data.templates[0].plan_id.toString(),c.value=s.data.templates[0].need_followup.toString(),f.value=s.data.templates.find(e=>e.template_id===p.value)?.records||[]},C=d(""),M=d(""),P=d(),E=d(""),j=d(""),N=d(""),k=d(""),g=d(""),p=d(""),U=d([]),f=d([]),L=()=>{f.value=_.value.find(s=>s.template_id===p.value)?.records||[],k.value=_.value.find(s=>s.template_id===p.value)?.visit_ids[0]+""||"",g.value=_.value.find(s=>s.template_id===p.value)?.plan_id+""||"",c.value=_.value.find(s=>s.template_id===p.value)?.need_followup+""||""},v=d(!1),i=d({date:"",type:"",patientContent:"",doctorContent:""}),O=()=>{v.value=!0},X=async()=>{await me({plan_id:parseInt(g.value),patient_id:parseInt(C.value),visit_id:parseInt(k.value),followup_date:i.value.date,followup_type:parseInt(i.value.type),symptoms:i.value.patientContent,evaluation:i.value.doctorContent}),V(),G({type:"success",message:"添加成功"}),i.value={date:"",type:"",patientContent:"",doctorContent:""},v.value=!1},$=async()=>{await ce({plan_id:parseInt(g.value),need_followup:parseInt(c.value)}),G({type:"success",message:"操作成功"}),V()},J=s=>{switch(s){case 0:return"门诊随访";case 1:return"电话随访";case 2:return"视频随访";case 3:return"家庭随访"}},K=s=>{switch(s){case 0:return"primary";case 1:return"success";case 2:return"warning";case 3:return"info";default:return"info"}};return(s,e)=>{const y=n("el-icon"),z=n("el-tag"),D=n("el-card"),A=n("el-radio"),Q=n("el-radio-group"),x=n("el-option"),T=n("el-select"),F=n("el-button"),W=n("DocumentEmpty"),Z=n("el-timeline-item"),ee=n("el-timeline"),te=n("el-date-picker"),w=n("el-form-item"),B=n("el-input"),le=n("el-form"),ae=n("el-dialog");return m(),h("div",_e,[t("div",fe,[e[25]||(e[25]=t("div",{class:"mb-4 flex items-center"},[t("div",{class:"w-1 h-8 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-full mr-3"}),t("h2",{class:"text-2xl font-bold text-gray-800 tracking-tight"},"患者随访详情")],-1)),l(D,{class:"mb-6 bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-blue-100","body-style":{padding:"20px 24px"}},{default:a(()=>[t("div",ve,[t("h3",xe,[l(y,{class:"!mr-2"},{default:a(()=>[l(b(de))]),_:1}),e[8]||(e[8]=r(" 患者基本信息 "))]),l(z,{type:"info",size:"small",class:"rounded-full px-3 py-1 font-medium"},{default:a(()=>[r("ID: "+u(C.value),1)]),_:1})]),t("div",be,[t("div",ge,[e[9]||(e[9]=t("span",{class:"text-xs text-gray-500 w-12"},"姓名",-1)),t("span",ye,u(M.value),1)]),t("div",we,[e[10]||(e[10]=t("span",{class:"text-xs text-gray-500 w-12"},"年龄",-1)),t("span",he,u(P.value)+"岁",1)]),t("div",Ve,[e[11]||(e[11]=t("span",{class:"text-xs text-gray-500 w-12"},"性别",-1)),t("span",Ce,u(E.value),1)]),t("div",ke,[e[12]||(e[12]=t("span",{class:"text-xs text-gray-500 w-12"},"病种",-1)),t("span",Ue,u(j.value||"暂无数据"),1)]),t("div",De,[e[13]||(e[13]=t("span",{class:"text-xs text-gray-500 w-16"},"主治医生",-1)),t("span",Fe,u(N.value),1)])])]),_:1}),l(D,{class:"shadow-xl bg-white/95 rounded-2xl border border-blue-100","body-style":{padding:"20px 24px"}},{default:a(()=>[t("div",Ie,[t("h3",Ye,[l(y,{class:"!mr-2"},{default:a(()=>[l(b(ie))]),_:1}),e[14]||(e[14]=r(" 随访信息 "))]),t("div",Me,[e[17]||(e[17]=t("span",{class:"text-sm text-gray-600"},"是否还需要随访：",-1)),l(Q,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o),onChange:$,size:"small"},{default:a(()=>[l(A,{value:"1",class:"mr-2"},{default:a(()=>e[15]||(e[15]=[r("是")])),_:1,__:[15]}),l(A,{value:"0"},{default:a(()=>e[16]||(e[16]=[r("否")])),_:1,__:[16]})]),_:1},8,["modelValue"])])]),t("div",Pe,[t("div",Ee,[e[18]||(e[18]=t("label",{class:"block text-sm text-gray-600 mb-1"},"随访方案",-1)),l(T,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),placeholder:"请选择",onChange:L,style:{width:"100%"},size:"default"},{default:a(()=>[(m(!0),h(R,null,S(U.value,o=>(m(),Y(x,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),t("div",je,[l(F,{type:"primary",onClick:O,disabled:c.value==="0",class:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 border-0 shadow-md hover:shadow-lg px-6 py-2 rounded-xl font-semibold",size:"default"},{default:a(()=>[l(y,{class:"mr-1"},{default:a(()=>[l(b(ue))]),_:1}),e[19]||(e[19]=r(" 添加随访记录 "))]),_:1,__:[19]},8,["disabled"])])]),t("div",Ne,[t("h4",ze," 随访记录 ("+u(f.value.length)+"条) ",1),f.value.length===0?(m(),h("div",Ae,[l(y,{class:"text-4xl mb-2"},{default:a(()=>[l(W)]),_:1}),e[20]||(e[20]=t("p",null,"暂无随访记录",-1))])):(m(),Y(ee,{key:1,class:"mt-2"},{default:a(()=>[(m(!0),h(R,null,S(f.value,(o,I)=>(m(),Y(Z,{key:I,timestamp:b(q)(o.followup_date).format("MM-DD"),placement:"top",hollow:I!==0,color:I===0?"#409EFF":"#E4E7ED"},{default:a(()=>[l(D,{class:"timeline-card shadow-md hover:shadow-xl transition-shadow bg-white/95 rounded-xl border border-blue-50","body-style":{padding:"16px"}},{default:a(()=>[t("div",Te,[t("div",Be,[l(z,{type:K(o.followup_type),size:"small",effect:"light",class:"rounded-full px-3 py-1 font-medium"},{default:a(()=>[r(u(J(o.followup_type)),1)]),_:2},1032,["type"]),t("span",Re,u(b(q)(o.followup_date).format("YYYY年MM月DD日")),1)])]),t("div",Se,[t("div",qe,[e[21]||(e[21]=t("p",{class:"text-blue-800 font-medium mb-1"},"患者自述：",-1)),t("p",Ge,u(o.symptoms||"无"),1)]),t("div",He,[e[22]||(e[22]=t("p",{class:"text-green-800 font-medium mb-1"},"医生建议：",-1)),t("p",Le,u(o.evaluation||"无"),1)])])]),_:2},1024)]),_:2},1032,["timestamp","hollow","color"]))),128))]),_:1}))])]),_:1}),l(ae,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o),title:"添加随访记录",width:"600px","close-on-click-modal":!1,class:"rounded-2xl"},{footer:a(()=>[t("div",Oe,[l(F,{onClick:e[6]||(e[6]=o=>v.value=!1)},{default:a(()=>e[23]||(e[23]=[r("取消")])),_:1,__:[23]}),l(F,{type:"primary",onClick:X,class:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 border-0 shadow-md hover:shadow-lg px-8"},{default:a(()=>e[24]||(e[24]=[r(" 确定添加 ")])),_:1,__:[24]})])]),default:a(()=>[l(le,{model:i.value,"label-width":"100px",class:"space-y-4"},{default:a(()=>[l(w,{label:"随访时间",required:""},{default:a(()=>[l(te,{modelValue:i.value.date,"onUpdate:modelValue":e[2]||(e[2]=o=>i.value.date=o),type:"date",placeholder:"选择日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(w,{label:"随访类型",required:""},{default:a(()=>[l(T,{modelValue:i.value.type,"onUpdate:modelValue":e[3]||(e[3]=o=>i.value.type=o),placeholder:"请选择类型",style:{width:"100%"}},{default:a(()=>[l(x,{label:"门诊随访",value:"0"}),l(x,{label:"电话随访",value:"1"}),l(x,{label:"视频随访",value:"2"}),l(x,{label:"家庭随访",value:"3"})]),_:1},8,["modelValue"])]),_:1}),l(w,{label:"患者自述"},{default:a(()=>[l(B,{modelValue:i.value.patientContent,"onUpdate:modelValue":e[4]||(e[4]=o=>i.value.patientContent=o),type:"textarea",rows:3,placeholder:"请输入患者自述内容",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(w,{label:"医生建议"},{default:a(()=>[l(B,{modelValue:i.value.doctorContent,"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.doctorContent=o),type:"textarea",rows:3,placeholder:"请输入医生建议内容",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])])}}}),Qe=re(Xe,[["__scopeId","data-v-439d9238"]]);export{Qe as default};
