import{d as C,o as M,r as p,X as H,c,e as t,f as s,aa as N,w as r,g as b,t as i,h as l,x as y,F as w,n as k,k as P,Z as R,G as j,ar as q,m as $,av as F,a as G,O as u,P as O}from"./index-iZTeaJac.js";import{a as S}from"./index-dUdC-nAQ.js";const T={class:"min-h-screen bg-gray-50 px-4 py-6"},U={class:"max-w-7xl mx-auto"},A={class:"mb-8"},E={class:"mb-4"},L={class:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z={class:"flex items-center space-x-3"},J={class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},K={class:"text-lg font-semibold text-gray-800"},Q={class:"flex items-center space-x-3"},W={class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},tt={class:"text-lg font-semibold text-gray-800"},et={class:"space-y-6"},st={class:"bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-100"},ot={class:"flex items-center justify-between"},at={class:"flex items-center space-x-4"},lt={class:"w-12 h-12 bg-white rounded-full flex items-center justify-center shadow-sm"},nt={class:"text-lg font-semibold text-gray-800"},rt={class:"text-sm text-gray-600"},it={class:"text-right"},dt={class:"text-sm font-medium text-gray-700"},ct={class:"p-6"},ut={class:"mb-4"},_t={class:"text-sm text-gray-600"},mt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},gt={class:"mb-4"},xt={class:"relative group cursor-pointer"},ft=["src"],pt=["onClick"],bt={class:"space-y-3"},ht={class:"text-sm font-medium text-gray-800 line-clamp-2"},vt={key:0,class:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center"},yt={class:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center"},wt=["src"],kt=C({__name:"details",setup(jt){const m=H(),D=G();M(()=>{V()});const g=p([]),V=async()=>{const e=(await S({inference_id:m.query.inference_id?.toString()})).data.results.reduce((d,a)=>{const o=a.patient_id;return d[o]||(d[o]={patient_id:o,patient_name:a.patient_name,inferred_at:a.inferred_at,inference_id:a.inference_id,results:[]}),d[o].results.push({attachment_url:a.attachment_url,conclusion:a.conclusion,confidence_score:a.confidence_score,result_text:a.result_text}),d},{}),n=Object.values(e);g.value=n},Y=()=>{D.go(-1)},h=_=>`//${_}`,x=p(!1),v=p(""),z=_=>{v.value=_,x.value=!0};return(_,e)=>{const n=b("el-icon"),d=b("el-button"),a=b("el-dialog");return u(),c("div",T,[t("div",U,[t("div",A,[t("div",E,[s(d,{onClick:Y,type:"text",class:"text-blue-600 hover:text-blue-800 p-0 h-auto font-medium"},{default:r(()=>[s(n,{class:"mr-1",size:"16"},{default:r(()=>[s(l(R))]),_:1}),e[1]||(e[1]=P(" 返回上一级 "))]),_:1,__:[1]})]),e[4]||(e[4]=t("div",{class:"flex items-center space-x-3 mb-4"},[t("div",{class:"w-1 h-8 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-full"}),t("h1",{class:"text-3xl font-bold text-gray-800"},"影像数据推理详情")],-1)),t("div",L,[t("div",X,[t("div",Z,[t("div",J,[s(n,{class:"text-blue-600",size:"20"},{default:r(()=>[s(l(j))]),_:1})]),t("div",null,[e[2]||(e[2]=t("p",{class:"text-sm text-gray-500 mb-1"},"任务名称",-1)),t("p",K,i(l(m).query.inference_name),1)])]),t("div",Q,[t("div",W,[s(n,{class:"text-green-600",size:"20"},{default:r(()=>[s(l(q))]),_:1})]),t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-500 mb-1"},"提交时间",-1)),t("p",tt,i(l(y)(l(m).query.submit_time).format("YYYY-MM-DD HH:mm:ss")),1)])])])])]),t("div",et,[(u(!0),c(w,null,k(g.value,(o,I)=>(u(),c("div",{key:I,class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},[t("div",st,[t("div",ot,[t("div",at,[t("div",lt,[s(n,{class:"text-blue-600",size:"20"},{default:r(()=>[s(l($))]),_:1})]),t("div",null,[t("h3",nt,i(o.patient_name),1),t("p",rt,"患者ID: "+i(o.patient_id),1)])]),t("div",it,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-500"},"推理时间",-1)),t("p",dt,i(l(y)(o.inferred_at).format("YYYY-MM-DD HH:mm:ss")),1)])])]),t("div",ct,[t("div",ut,[e[6]||(e[6]=t("h4",{class:"text-lg font-semibold text-gray-800 mb-2"},"推理结果",-1)),t("p",_t,"共 "+i(o.results.length)+" 个结果",1)]),t("div",mt,[(u(!0),c(w,null,k(o.results,(f,B)=>(u(),c("div",{key:B,class:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors duration-200"},[t("div",gt,[t("div",xt,[t("img",{src:h(f.attachment_url),alt:"病理图像",class:"w-full h-32 object-cover rounded-lg shadow-sm group-hover:shadow-md transition-shadow duration-200"},null,8,ft),t("div",{onClick:Dt=>z(h(f.attachment_url)),class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 rounded-lg transition-all duration-200 flex items-center justify-center"},[s(n,{class:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200",size:"24"},{default:r(()=>[s(l(F))]),_:1})],8,pt)])]),t("div",bt,[t("div",null,[e[7]||(e[7]=t("p",{class:"text-xs text-gray-500 uppercase tracking-wider mb-1"},"推理结果",-1)),t("p",ht,i(f.result_text),1)])])]))),128))])])]))),128))]),g.value.length===0?(u(),c("div",vt,[t("div",yt,[s(n,{size:"24",class:"text-gray-400"},{default:r(()=>[s(l(j))]),_:1})]),e[8]||(e[8]=t("h3",{class:"text-lg font-medium text-gray-600 mb-2"},"暂无推理结果",-1)),e[9]||(e[9]=t("p",{class:"text-gray-500"},"该任务还没有生成推理结果",-1))])):N("",!0)]),s(a,{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=o=>x.value=o),width:"80%",center:""},{default:r(()=>[t("img",{src:v.value,alt:"预览",class:"w-full h-auto"},null,8,wt)]),_:1},8,["modelValue"])])}}}),zt=O(kt,[["__scopeId","data-v-33972cb3"]]);export{zt as default};
