import{d as B,r as u,o as N,c as y,f as s,w as i,h as a,aE as k,ao as H,aS as O,M as j,e,k as _,aq as p,A as G,t as n,an as z,U as R,a8 as W,aL as q,p as P,aM as c,ap as w,aT as J,aU as $,m as F,J as K,ar as Q,a4 as X,aN as Z,aO as ee,aa as te,aP as ae,x as D,O as f,P as se}from"./index-iZTeaJac.js";const le={class:"w-full h-full"},oe={class:"bg-gradient-to-r from-blue-500 to-indigo-600 -m-6 mb-6 p-6"},ie={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},ne={class:"text-white mb-4 sm:mb-0"},de={class:"text-xl font-semibold flex items-center"},re={class:"text-blue-100 text-sm mt-1"},ce={class:"flex gap-3"},ue={class:"overflow-x-auto"},_e={class:"flex items-center"},pe={class:"text-gray-700"},fe={class:"flex items-center"},me={class:"font-medium text-gray-700"},ge={class:"flex items-center text-gray-600"},ve={class:"bg-gray-100 px-2 py-1 rounded text-xs"},be={class:"flex items-center text-gray-600"},xe={class:"flex flex-col"},he={class:"text-sm font-medium"},ye={class:"text-xs text-gray-500"},we={key:1,class:"text-gray-400"},De={class:"mt-8 flex justify-center"},Ee={key:0,class:"space-y-6"},Ce={class:"flex items-center text-blue-700"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ze={class:"detail-item"},Pe={class:"detail-value"},Te={class:"detail-item"},Se={class:"detail-item md:col-span-2"},Ie={class:"detail-value"},Ae={class:"detail-item"},Le={class:"detail-value"},Me={class:"detail-item"},Ve={class:"detail-value"},Ue={class:"detail-item"},Ye={class:"detail-value bg-gray-100 px-2 py-1 rounded text-sm"},Be={class:"detail-item"},Ne={class:"detail-value"},He={class:"detail-item"},Oe={class:"detail-value"},je={class:"detail-item"},Ge={class:"detail-value"},Re=B({__name:"index",setup(We){const m=u(!1),g=u([]),v=u([]),b=u(!1),r=u(null),d=u({currentPage:1,pageSize:10,total:0}),T={backgroundColor:"#f8fafc",color:"#374151",fontWeight:"600",borderBottom:"2px solid #e5e7eb"},S=({rowIndex:l})=>({backgroundColor:l%2===0?"#ffffff":"#f9fafb"}),E=async()=>{try{m.value=!0;const l=await O();l.data&&Array.isArray(l.data)?(v.value=l.data,d.value.total=l.data.length,x()):(g.value=[],v.value=[],d.value.total=0)}catch{j.error("加载日志数据失败"),g.value=[],v.value=[]}finally{m.value=!1}},x=()=>{const l=(d.value.currentPage-1)*d.value.pageSize,t=l+d.value.pageSize;g.value=v.value.slice(l,t)},I=()=>{d.value.currentPage=1,E()},A=l=>{r.value=l,b.value=!0},L=l=>{d.value.pageSize=l,d.value.currentPage=1,x()},M=l=>{d.value.currentPage=l,x()},V=l=>D(l).format("YYYY-MM-DD"),U=l=>D(l).format("HH:mm:ss"),Y=l=>D(l).format("YYYY-MM-DD HH:mm:ss"),C=l=>{const t={CREATE:"success",UPDATE:"warning",DELETE:"danger",LOGIN:"info",LOGOUT:"info",VIEW:"info"},h=l?.toUpperCase();for(const o in t)if(h?.includes(o))return t[o];return"info"};return N(()=>{E()}),(l,t)=>{const h=q("loading");return f(),y("div",le,[s(a(k),{class:"shadow-xl border-0 rounded-2xl overflow-hidden"},{default:i(()=>[e("div",oe,[e("div",ie,[e("div",ne,[e("h3",de,[s(a(p),{class:"mr-2"},{default:i(()=>[s(a(G))]),_:1}),t[3]||(t[3]=_(" 日志列表 "))]),e("p",re,"共 "+n(d.value.total)+" 条记录",1)]),e("div",ce,[s(a(z),{type:"primary",icon:a(R),onClick:I,loading:m.value,class:"bg-white/20 border-white/30 text-white hover:bg-white/30"},{default:i(()=>t[4]||(t[4]=[_(" 刷新 ")])),_:1,__:[4]},8,["icon","loading"])])])]),e("div",ue,[W((f(),P(a(Z),{data:g.value,stripe:"",class:"w-full log-table","header-cell-style":T,"row-style":S,"empty-text":"暂无日志数据",height:"400"},{default:i(()=>[s(a(c),{type:"index",label:"#",width:"60",align:"center"}),s(a(c),{prop:"action",label:"操作类型","min-width":"120"},{default:i(({row:o})=>[s(a(w),{type:C(o.action),effect:"light",class:"font-medium"},{default:i(()=>[_(n(o.action),1)]),_:2},1032,["type"])]),_:1}),s(a(c),{prop:"action_text",label:"操作描述","min-width":"200","show-overflow-tooltip":""},{default:i(({row:o})=>[e("div",_e,[s(a(p),{class:"mr-2 text-gray-500"},{default:i(()=>[s(a(J))]),_:1}),e("span",pe,n(o.action_text),1)])]),_:1}),s(a(c),{prop:"user_name",label:"操作用户",width:"120"},{default:i(({row:o})=>[e("div",fe,[s(a($),{size:24,class:"mr-2"},{default:i(()=>[s(a(p),null,{default:i(()=>[s(a(F))]),_:1})]),_:1}),e("span",me,n(o.user_name||"未知用户"),1)])]),_:1}),s(a(c),{prop:"ip_address",label:"IP地址",width:"140"},{default:i(({row:o})=>[e("div",ge,[s(a(p),{class:"mr-2 text-blue-500"},{default:i(()=>[s(a(K))]),_:1}),e("code",ve,n(o.ip_address),1)])]),_:1}),s(a(c),{prop:"timestamp",label:"操作时间",width:"180",sortable:""},{default:i(({row:o})=>[e("div",be,[s(a(p),{class:"!mr-2 text-green-500"},{default:i(()=>[s(a(Q))]),_:1}),e("div",xe,[e("span",he,n(V(o.timestamp)),1),e("span",ye,n(U(o.timestamp)),1)])])]),_:1}),s(a(c),{prop:"target_table",label:"目标表",width:"120","show-overflow-tooltip":""},{default:i(({row:o})=>[o.target_table?(f(),P(a(w),{key:0,size:"small",effect:"plain",class:"bg-purple-50 text-purple-600 border-purple-200"},{default:i(()=>[_(n(o.target_table),1)]),_:2},1024)):(f(),y("span",we,"-"))]),_:1}),s(a(c),{label:"详细信息",width:"100",align:"center"},{default:i(({row:o})=>[s(a(z),{type:"primary",link:"",onClick:qe=>A(o),icon:a(X),class:"text-blue-500 hover:text-blue-700"},{default:i(()=>t[5]||(t[5]=[_(" 详情 ")])),_:2,__:[5]},1032,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[h,m.value]])]),e("div",De,[s(a(ee),{"current-page":d.value.currentPage,"onUpdate:currentPage":t[0]||(t[0]=o=>d.value.currentPage=o),"page-size":d.value.pageSize,"onUpdate:pageSize":t[1]||(t[1]=o=>d.value.pageSize=o),"page-sizes":[10,20,50,100],total:d.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:M,background:""},null,8,["current-page","page-size","total"])])]),_:1}),s(a(H),{modelValue:b.value,"onUpdate:modelValue":t[2]||(t[2]=o=>b.value=o),width:"60%","destroy-on-close":"","show-close":!1,class:"log-detail-dialog"},{default:i(()=>[r.value?(f(),y("div",Ee,[s(a(k),{class:"border-0 shadow-sm bg-gradient-to-r from-blue-50 to-indigo-50"},{header:i(()=>[e("div",Ce,[s(a(p),{class:"mr-2"},{default:i(()=>[s(a(ae))]),_:1}),t[6]||(t[6]=e("span",{class:"font-semibold"},"基本信息",-1))])]),default:i(()=>[e("div",ke,[e("div",ze,[t[7]||(t[7]=e("span",{class:"detail-label"},"日志ID",-1)),e("span",Pe,n(r.value.log_id),1)]),e("div",Te,[t[8]||(t[8]=e("span",{class:"detail-label"},"操作类型",-1)),s(a(w),{type:C(r.value.action),class:"detail-value"},{default:i(()=>[_(n(r.value.action),1)]),_:1},8,["type"])]),e("div",Se,[t[9]||(t[9]=e("span",{class:"detail-label"},"操作描述",-1)),e("span",Ie,n(r.value.action_text),1)]),e("div",Ae,[t[10]||(t[10]=e("span",{class:"detail-label"},"用户ID",-1)),e("span",Le,n(r.value.user_id),1)]),e("div",Me,[t[11]||(t[11]=e("span",{class:"detail-label"},"用户名",-1)),e("span",Ve,n(r.value.user_name||"未知用户"),1)]),e("div",Ue,[t[12]||(t[12]=e("span",{class:"detail-label"},"IP地址",-1)),e("code",Ye,n(r.value.ip_address),1)]),e("div",Be,[t[13]||(t[13]=e("span",{class:"detail-label"},"操作时间",-1)),e("span",Ne,n(Y(r.value.timestamp)),1)]),e("div",He,[t[14]||(t[14]=e("span",{class:"detail-label"},"目标表",-1)),e("span",Oe,n(r.value.target_table||"-"),1)]),e("div",je,[t[15]||(t[15]=e("span",{class:"detail-label"},"目标ID",-1)),e("span",Ge,n(r.value.target_id||"-"),1)])])]),_:1})])):te("",!0)]),_:1},8,["modelValue"])])}}}),$e=se(Re,[["__scopeId","data-v-faee4812"]]);export{$e as default};
