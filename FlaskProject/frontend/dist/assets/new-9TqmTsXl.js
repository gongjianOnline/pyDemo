import{d as T,r as n,o as j,c as y,e as l,f as a,w as o,g as u,b as q,R as H,Q,k as r,h as m,ad as G,ae as J,F as A,n as U,p as P,t as K,I as W,T as X,af as Y,a as Z,M as B,O as p,P as $}from"./index-iZTeaJac.js";import{U as ee}from"./userListComponents-F1YBBUwJ.js";import{t as le}from"./index-2Fl6aFRQ.js";import{b as ae}from"./index-dUdC-nAQ.js";const te={class:"min-h-screen bg-gradient-to-br from-slate-50 to-gray-100 p-6"},se={class:"max-w-7xl mx-auto"},oe={class:"grid grid-cols-1 lg:grid-cols-4 gap-2"},ne={class:"lg:col-span-1 space-y-6"},de={class:"flex items-center gap-3 text-gray-700 font-semibold"},ie={class:"space-y-6 p-4"},ue={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},re={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2"},ce={class:"pt-4"},me={class:"lg:col-span-3"},pe={class:"flex items-center gap-3 text-gray-700 font-semibold"},_e={class:"p-6 bg-gray-50/50 rounded-xl"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ve={class:"flex items-end"},fe={class:"bg-gray-50/30 rounded-xl min-h-[400px]"},ge=T({__name:"new",setup(xe){const _=n(!1),g=n(""),D=n(""),b=n(""),k=Z(),w=n([]),d=n({name:"",disease:"",sex:""}),h=n([]),V=n([]),c=n(""),C=n(""),M=t=>{b.value=t.map(e=>e.patient_id).join(",")},N=t=>{k.push({name:"dataCollection_details",query:{patient_id:t.patient_id}})},S=async()=>{const t=await q();C.value=t.data.doctor_id},z=async()=>{const t=await le({model_id:"1"});for(let e=0;e<t.data.length;e++)V.value[e]={label:t.data[e].task_name,value:t.data[e].task_id}},I=async(t,e,i)=>{const v=await H({patient_name:t,tag_id:e,gender:i});w.value=v.data},E=async()=>{const t=await Q();h.value=[{tag_id:"",name:"全部类型"},...t.data]},O=async()=>{if(!c.value||!b.value){B.warning("请选择模型和患者");return}_.value=!0;try{const t=await ae({doctor_id:C.value,task_id:c.value,inference_name:g.value,remarks:D.value,patient_ids:b.value});t.code===200&&(B.success(t.message),k.back())}finally{_.value=!1}},R=()=>{I(d.value.name,d.value.disease,d.value.sex)};return j(()=>{S(),z(),E(),I("","","")}),(t,e)=>{const i=u("el-icon"),v=u("el-input"),f=u("el-option"),x=u("el-select"),L=u("el-button"),F=u("el-card");return p(),y("div",te,[e[13]||(e[13]=l("div",{class:"mb-2 flex items-center"},[l("div",{class:"flex items-center space-x-3 mb-3"},[l("div",{class:"w-1 h-8 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-full"}),l("h1",{class:"text-3xl font-bold text-gray-800"},"疾病风险预测-新增预测")])],-1)),l("div",se,[l("div",oe,[l("div",ne,[a(F,{class:"shadow-lg border-0 bg-white/90 backdrop-blur-sm"},{header:o(()=>[l("div",de,[a(i,{class:"text-blue-600"},{default:o(()=>[a(m(W))]),_:1}),e[5]||(e[5]=r(" 方案配置 "))])]),default:o(()=>[l("div",ie,[l("div",null,[l("label",ue,[a(i,{class:"text-gray-500"},{default:o(()=>[a(m(G))]),_:1}),e[6]||(e[6]=r(" 方案名称 "))]),a(v,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),placeholder:"请输入预测方案名称",class:"w-full"},null,8,["modelValue"])]),l("div",null,[l("label",re,[a(i,{class:"text-gray-500"},{default:o(()=>[a(m(J))]),_:1}),e[7]||(e[7]=r(" AI预测模型 "))]),a(x,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=s=>c.value=s),placeholder:"选择智能预测模型",class:"w-full",size:"default"},{default:o(()=>[(p(!0),y(A,null,U(V.value,s=>(p(),P(f,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",ce,[a(L,{type:"primary",size:"large",onClick:O,loading:_.value,class:"w-full h-12 text-base font-semibold bg-gradient-to-r from-blue-600 to-blue-700 border-0 hover:from-blue-700 hover:to-blue-800",disabled:!c.value||!b.value},{default:o(()=>[a(i,{class:"mr-2"}),r(" "+K(_.value?"正在推理分析...":"开始AI推理"),1)]),_:1},8,["loading","disabled"])])])]),_:1})]),l("div",me,[a(F,{class:"shadow-lg border-0 bg-white/90 backdrop-blur-sm min-h-[600px]"},{header:o(()=>[l("div",pe,[a(i,{class:"text-blue-600"},{default:o(()=>[a(m(Y))]),_:1}),e[8]||(e[8]=r(" 患者筛选与选择 "))])]),default:o(()=>[l("div",_e,[l("div",be,[l("div",null,[e[9]||(e[9]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"患者姓名",-1)),a(v,{modelValue:d.value.name,"onUpdate:modelValue":e[2]||(e[2]=s=>d.value.name=s),placeholder:"输入患者姓名",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),l("div",null,[e[10]||(e[10]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"疾病类型",-1)),a(x,{modelValue:d.value.disease,"onUpdate:modelValue":e[3]||(e[3]=s=>d.value.disease=s),placeholder:"选择病种",clearable:"",class:"w-full"},{default:o(()=>[(p(!0),y(A,null,U(h.value,s=>(p(),P(f,{key:s.tag_id,label:s.name,value:s.tag_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",null,[e[11]||(e[11]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"患者性别",-1)),a(x,{modelValue:d.value.sex,"onUpdate:modelValue":e[4]||(e[4]=s=>d.value.sex=s),placeholder:"选择性别",clearable:"",class:"w-full"},{default:o(()=>[a(f,{label:"男性",value:"0"}),a(f,{label:"女性",value:"1"})]),_:1},8,["modelValue"])]),l("div",ve,[a(L,{type:"primary",onClick:R,class:"w-full bg-blue-600 border-blue-600 hover:bg-blue-700"},{default:o(()=>[a(i,null,{default:o(()=>[a(m(X))]),_:1}),e[12]||(e[12]=r(" 筛选 "))]),_:1,__:[12]})])])]),l("div",fe,[a(ee,{"table-data":w.value,type:"selection",colNum:3,onHandleDetails:N,onSelectionChange:M},null,8,["table-data"])])]),_:1})])])])])}}}),Ve=$(ge,[["__scopeId","data-v-8c532884"]]);export{Ve as default};
