import{d as S,u as U,o as j,r as u,c as x,f as s,e as t,w as l,g as n,a1 as A,aa as w,t as _,h as d,ag as O,G as v,I as R,F as G,n as T,p as k,ah as C,k as V,ai as W,aj as $,a as q,O as m,M as b,W as H,P as J}from"./index-iZTeaJac.js";import{t as K}from"./index-2Fl6aFRQ.js";import{b as Q}from"./index-Bqa-GVRE.js";const X={class:"min-h-screen bg-gray-50 px-4 py-6"},Y={class:"max-w-7xl mx-auto"},Z={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ee={class:"space-y-6"},te={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},se={class:"p-6"},le={class:"flex items-center space-x-3 mb-4"},ae={class:"space-y-4"},oe={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},de={class:"p-6"},re={class:"flex items-center space-x-3 mb-4"},ne={class:"space-y-4"},ie={class:"flex justify-between items-center"},ce={class:"font-medium"},ue={class:"text-gray-400 text-sm"},me={class:"space-y-6"},pe={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},ge={class:"p-6"},_e={class:"flex items-center space-x-3 mb-4"},fe={class:"space-y-4"},xe={class:"flex items-center justify-between p-4 bg-blue-50 border border-blue-200 rounded-lg"},ve={class:"flex items-center space-x-3"},be={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors duration-300"},ye={class:"py-4"},he={key:0,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},we={class:"flex items-center space-x-2"},ke={class:"text-green-700 font-medium"},Ce={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},Ve=S({__name:"new",setup(Me){const M=U(),y=q();j(()=>{N()});const p=u(""),c=u(!1),h=u([]),g=u(""),N=async()=>{const i=await K({model_id:"2"});h.value=i.data},I=async()=>{if(r.value.length===0){b({type:"error",message:"请上传模板数据"});return}const i=H.service({lock:!0,text:"正在创建方案，请稍候...",background:"rgba(225, 225, 225, 0.7)"});c.value=!0;try{const e=new FormData;e.append("inference_name",p.value),e.append("doctor_id",M.getDoctorId),e.append("task_id",g.value),e.append("file",r.value[0].raw),await Q(e),b({type:"success",message:"创建完成"}),y.back()}catch{b({type:"error",message:"创建失败，请重试"})}finally{i.close(),c.value=!1}},r=u([]),B=()=>{const i="//uploads/template/诊疗优化模板.xlsx",e="导入模板",a=document.createElement("a");a.href=i,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)},D=()=>{y.back()};return(i,e)=>{const a=n("el-icon"),f=n("el-button"),E=n("el-input"),F=n("el-option"),L=n("el-select"),z=n("el-upload"),P=n("Magic");return m(),x("div",X,[s(f,{onClick:D,class:"mb-2 flex items-center space-x-2 text-gray-600 hover:text-gray-800 bg-white hover:bg-gray-50 border border-gray-200 hover:border-gray-300 transition-all duration-200 px-4 py-2 rounded-lg shadow-sm"},{default:l(()=>[s(a,null,{default:l(()=>[s(d(O))]),_:1}),e[3]||(e[3]=t("span",{class:"font-medium"},"返回",-1))]),_:1,__:[3]}),t("div",Y,[e[16]||(e[16]=A('<div class="mb-2 flex items-center" data-v-80526d42><div class="flex items-center space-x-3 mb-3" data-v-80526d42><div class="w-1 h-8 bg-gradient-to-b from-blue-500 to-indigo-600 rounded-full" data-v-80526d42></div><h1 class="text-3xl font-bold text-gray-800" data-v-80526d42>临床研究模型推理</h1></div><p class="text-gray-600 ml-7" data-v-80526d42>基于AI模型的个性化临床研究系统</p></div>',1)),t("div",Z,[t("div",ee,[t("div",te,[e[6]||(e[6]=t("div",{class:"h-1 bg-gradient-to-r from-blue-400 to-blue-500"},null,-1)),t("div",se,[t("div",le,[s(a,{class:"text-blue-500 text-xl"},{default:l(()=>[s(d(v))]),_:1}),e[4]||(e[4]=t("h2",{class:"text-xl font-semibold text-gray-700"},"方案配置",-1))]),t("div",ae,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-600 mb-2"},"方案名称",-1)),s(E,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o),placeholder:"请输入预测方案名称",size:"large",clearable:"",class:"rounded-lg"},{prefix:l(()=>[s(a,{class:"text-gray-400"},{default:l(()=>[s(d(v))]),_:1})]),_:1},8,["modelValue"])])])])]),t("div",oe,[e[9]||(e[9]=t("div",{class:"h-1 bg-gradient-to-r from-green-400 to-green-500"},null,-1)),t("div",de,[t("div",re,[s(a,{class:"text-green-500 text-xl"},{default:l(()=>[s(d(R))]),_:1}),e[7]||(e[7]=t("h2",{class:"text-xl font-semibold text-gray-700"},"模型&算法选择",-1))]),t("div",ne,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-600 mb-2"},"选择预测模型",-1)),s(L,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=o=>g.value=o),placeholder:"请选择模型",size:"large",class:"w-full rounded-lg",clearable:""},{default:l(()=>[(m(!0),x(G,null,T(h.value,o=>(m(),k(F,{key:o.task_id,label:o.task_name,value:o.task_id},{default:l(()=>[t("div",ie,[t("span",ce,_(o.task_name),1),t("span",ue,_(o.remarks),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])])])])]),t("div",me,[t("div",pe,[e[15]||(e[15]=t("div",{class:"h-1 bg-gradient-to-r from-purple-400 to-purple-500"},null,-1)),t("div",ge,[t("div",_e,[s(a,{class:"text-purple-500 text-xl"},{default:l(()=>[s(d(C))]),_:1}),e[10]||(e[10]=t("h2",{class:"text-xl font-semibold text-gray-700"},"数据上传",-1))]),t("div",fe,[t("div",xe,[t("div",ve,[s(a,{class:"text-blue-500"},{default:l(()=>[s(d(v))]),_:1}),e[11]||(e[11]=t("div",null,[t("div",{class:"font-medium text-gray-800"},"数据模板"),t("div",{class:"text-sm text-gray-600"},"参考该模板格式填写真实患者信息")],-1))]),s(f,{type:"primary",onClick:B,size:"default",plain:""},{default:l(()=>[s(a,{class:"mr-2"},{default:l(()=>[s(d(W))]),_:1}),e[12]||(e[12]=V(" 下载模板 "))]),_:1,__:[12]})]),t("div",be,[s(z,{"file-list":r.value,"onUpdate:fileList":e[2]||(e[2]=o=>r.value=o),ref:"uploadRef","auto-upload":!1,class:"upload-demo","show-file-list":!0,drag:"",accept:".xlsx,.xls"},{default:l(()=>[t("div",ye,[s(a,{class:"text-4xl text-gray-400 mb-4"},{default:l(()=>[s(d(C))]),_:1}),e[13]||(e[13]=t("div",{class:"text-lg font-medium text-gray-700 mb-2"},"点击或拖拽文件到此处上传",-1)),e[14]||(e[14]=t("div",{class:"text-sm text-gray-500"},"支持 .xlsx, .xls 格式文件",-1))])]),_:1},8,["file-list"])]),r.value.length>0?(m(),x("div",he,[t("div",we,[s(a,{class:"text-green-500"},{default:l(()=>[s(d($))]),_:1}),t("span",ke,"已选择文件: "+_(r.value[0]?.name),1)])])):w("",!0)])])]),t("div",Ce,[s(f,{type:"primary",size:"large",onClick:I,class:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 border-0 transition-all duration-300 shadow-lg hover:shadow-xl",loading:c.value,disabled:!p.value||!g.value||r.value.length===0},{default:l(()=>[c.value?w("",!0):(m(),k(a,{key:0,class:"mr-2"},{default:l(()=>[s(P)]),_:1})),V(" "+_(c.value?"推理中...":"模型推理"),1)]),_:1},8,["loading","disabled"])])])])])])}}}),De=J(Ve,[["__scopeId","data-v-80526d42"]]);export{De as default};
