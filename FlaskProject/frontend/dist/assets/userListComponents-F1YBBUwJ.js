import{d as Y,r as y,au as h,aw as $,o as M,c as i,aa as g,f as z,g as U,e as t,Y as f,F,n as P,O as r,t as c,k,h as T,x as b,ab as E,P as O}from"./index-iZTeaJac.js";const q={class:"w-full h-full bg-gray-50 p-6"},G={key:0,class:"mb-1 ml-2"},H={key:1,class:"flex flex-col items-center justify-center py-16"},J=["onClick"],K={key:0,class:"fas fa-check text-white text-xs absolute top-0.5 left-0.5"},Q={class:"flex items-center mb-4"},R={class:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-semibold text-lg mr-3 flex-shrink-0"},W={class:"flex-1 min-w-0"},X={class:"font-semibold text-gray-800 text-lg group-hover:text-blue-600 transition-colors truncate"},Z={class:"flex items-center space-x-2 mt-1"},ee={class:"text-xs text-gray-500 text-center"},te={class:"space-y-3"},se={class:"flex items-center text-sm"},le={class:"text-gray-800 ml-1 font-mono truncate text-left"},ae={class:"flex items-center text-sm"},ne={class:"text-gray-800 ml-1 font-mono text-left"},oe={class:"flex items-center text-sm"},ie={class:"text-gray-800 ml-1 text-left"},re={class:"flex items-center text-sm"},ce={class:"text-gray-800 ml-1 truncate text-left"},de={class:"mt-6 pt-4 border-t border-gray-100"},ue={class:"flex justify-end space-x-2"},fe=["onClick"],me=Y({__name:"userListComponents",props:{tableData:{default:()=>[]},type:{default:""},colNum:{default:4},selectArr:{default:()=>[]},defaultSelectIds:{default:""}},emits:["selection-change","handle-details"],setup(S,{expose:D,emit:w}){const a=S,d=w,n=y([]),v=h(()=>a.tableData.length),p=h(()=>n.value.length),C=h(()=>{const e=p.value;return e>0&&e<v.value}),I=e=>b().diff(b(e),"year"),A=()=>a.defaultSelectIds?a.defaultSelectIds.split(",").map(e=>parseInt(e.trim())).filter(e=>!isNaN(e)):[],_=()=>{if(a.type!=="selection"){n.value=[];return}let e=[];if(a.selectArr.length>0?e=a.selectArr:a.defaultSelectIds&&(e=A()),e.length>0){const s=new Set(e);n.value=a.tableData.filter(o=>s.has(o.patient_id))}else n.value=[];m()},m=()=>{a.tableData.length===0?u.value=!1:u.value=n.value.length===a.tableData.length};$([()=>a.selectArr,()=>a.tableData,()=>a.defaultSelectIds],()=>{_()},{deep:!0}),M(()=>{_()});const N=e=>{if(a.type==="selection"){const s=n.value.findIndex(o=>o.patient_id===e.patient_id);s>-1?n.value.splice(s,1):n.value.push(e),m(),d("selection-change",n.value)}},x=e=>n.value.some(s=>s.patient_id===e.patient_id),u=y(!1),V=()=>{u.value?n.value=[...a.tableData]:n.value=[],d("selection-change",n.value)},j=e=>{d("handle-details",e)};return D({clearSelection:()=>{n.value=[],u.value=!1,d("selection-change",[])},selectAll:()=>{n.value=[...a.tableData],u.value=!0,d("selection-change",[...n.value])},getSelectedPatients:()=>[...n.value],setSelectionByIds:e=>{if(a.type==="selection"){const s=new Set(e);n.value=a.tableData.filter(o=>s.has(o.patient_id)),m(),d("selection-change",[...n.value])}},setSelectionByString:e=>{if(a.type==="selection"&&e){const s=e.split(",").map(l=>parseInt(l.trim())).filter(l=>!isNaN(l)),o=new Set(s);n.value=a.tableData.filter(l=>o.has(l.patient_id)),m(),d("selection-change",[...n.value])}}}),(e,s)=>{const o=U("el-checkbox");return r(),i("div",q,[a.type==="selection"?(r(),i("div",G,[z(o,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=l=>u.value=l),label:`全选 (${p.value}/${v.value})`,size:"large",onChange:V,indeterminate:C.value},null,8,["modelValue","label","indeterminate"])])):g("",!0),e.tableData.length===0?(r(),i("div",H,s[1]||(s[1]=[t("div",{class:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4"},[t("i",{class:"fas fa-users text-gray-400 text-2xl"})],-1),t("p",{class:"text-gray-500 text-lg"},"暂无患者数据",-1)]))):(r(),i("div",{key:2,class:f(["grid gap-6",[`grid-cols-${a.colNum}`]])},[(r(!0),i(F,null,P(e.tableData,(l,B)=>(r(),i("div",{key:l.patient_id||B,onClick:L=>N(l),class:f(["bg-white rounded-xl shadow-sm border p-6 hover:shadow-md transition-all duration-200 cursor-pointer group relative",{"border-blue-500 ring-2 ring-blue-200":x(l),"hover:border-blue-300":a.type==="selection"&&!x(l)}])},[a.type==="selection"?(r(),i("div",{key:0,class:f(["absolute top-4 right-4 w-5 h-5 rounded-full border-2 transition-all duration-200",x(l)?"bg-blue-500 border-blue-500":"border-gray-300 group-hover:border-blue-400"])},[x(l)?(r(),i("i",K)):g("",!0)],2)):g("",!0),t("div",Q,[t("div",R,c(l.name.charAt(0)),1),t("div",W,[t("h3",X,c(l.name),1),t("div",Z,[t("span",{class:f(["inline-flex items-center justify-center px-2 py-1 rounded-full text-xs font-medium text-center",l.gender===0?"bg-blue-100 text-blue-800":"bg-pink-100 text-pink-800"])},[t("i",{class:f([l.gender===0?"fas fa-mars":"fas fa-venus","mr-1"])},null,2),k(" "+c(l.gender===0?"男":"女"),1)],2),t("span",ee,c(I(l.birth_date))+"岁 ",1)])])]),t("div",te,[t("div",se,[s[2]||(s[2]=t("span",{class:"text-gray-600 flex-shrink-0"},"证件号：",-1)),t("span",le,c(l.id_card),1)]),t("div",ae,[s[3]||(s[3]=t("span",{class:"text-gray-600 flex-shrink-0"},"联系电话：",-1)),t("span",ne,c(l.phone),1)]),t("div",oe,[s[4]||(s[4]=t("span",{class:"text-gray-600 flex-shrink-0"},"近一次就诊：",-1)),t("span",ie,c(T(b)(l.latest_visit_date).format("YYYY-MM-DD")),1)]),t("div",re,[s[5]||(s[5]=t("span",{class:"text-gray-600 flex-shrink-0"},"医疗编号：",-1)),t("span",ce,c(l.medical_insurance_no),1)])]),t("div",de,[t("div",ue,[t("button",{size:"small",class:"px-4 py-1 text-sm text-blue-600 bg-blue-50 hover:bg-blue-100 hover:text-blue-700 rounded-lg transition-all duration-200 font-medium border border-blue-200",onClick:E(L=>j(l),["stop"])},s[6]||(s[6]=[t("i",{class:"fas fa-eye mr-1"},null,-1),k(" 查看详情 ")]),8,fe)])])],10,J))),128))],2))])}}}),he=O(me,[["__scopeId","data-v-85e416e5"]]);export{he as U};
